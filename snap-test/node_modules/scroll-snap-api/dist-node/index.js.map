{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["export function scrollSnapToNext(element, direction, scrollToOptions = { behavior: 'smooth' }) {\r\n    // Pretend we're already this many pixels past the current scroll point in the direction we want to go.\r\n    // Helps avoid rounding errors in element sizes.\r\n    let scrollFuzz = 2;\r\n    const axis = (direction === 'up' || direction === 'down') ? 'y' : 'x';\r\n    const sign = (direction === 'right' || direction === 'down') ? '+' : '-';\r\n    const maxScroll = (axis === 'x') ?\r\n        element.scrollWidth - element.offsetWidth :\r\n        element.scrollHeight - element.offsetHeight;\r\n    const scrollSnapPositions = getScrollSnapPositions(element)[axis];\r\n    if (sign === '-') {\r\n        scrollFuzz *= -1;\r\n    }\r\n    const currentScrollPosition = element[axis === 'x' ? 'scrollLeft' : 'scrollTop'] + scrollFuzz;\r\n    const nextScrollPositions = scrollSnapPositions\r\n        .filter(pos => {\r\n        if (sign === '+') {\r\n            return pos > currentScrollPosition;\r\n        }\r\n        else {\r\n            return pos < currentScrollPosition;\r\n        }\r\n    })\r\n        .sort((a, b) => sign === '+' ? a - b : b - a);\r\n    let nextScrollPosition;\r\n    if (nextScrollPositions.length > 0) {\r\n        nextScrollPosition = nextScrollPositions[0];\r\n    }\r\n    else {\r\n        if (sign === '+') {\r\n            nextScrollPosition = maxScroll;\r\n        }\r\n        else {\r\n            nextScrollPosition = 0;\r\n        }\r\n    }\r\n    // scrollTo might return a promise in the future\r\n    return element.scrollTo({\r\n        ...scrollToOptions,\r\n        [axis === 'x' ? 'left' : 'top']: nextScrollPosition,\r\n    });\r\n}\r\nexport function getScrollPadding(element) {\r\n    const style = window.getComputedStyle(element);\r\n    const rect = element.getBoundingClientRect();\r\n    let xBeforeRaw = style.getPropertyValue('scroll-padding-left').replace('auto', '0px');\r\n    let yBeforeRaw = style.getPropertyValue('scroll-padding-top').replace('auto', '0px');\r\n    let xAfterRaw = style.getPropertyValue('scroll-padding-right').replace('auto', '0px');\r\n    let yAfterRaw = style.getPropertyValue('scroll-padding-bottom').replace('auto', '0px');\r\n    /**\r\n     * Convert a CSS length to a number.\r\n     * @param raw CSS length value\r\n     * @param size Parent size, used for percentage lengths\r\n     */\r\n    function convert(raw, size) {\r\n        let n = parseFloat(raw);\r\n        if (/%/.test(raw)) {\r\n            n /= 100;\r\n            n *= size;\r\n        }\r\n        return n;\r\n    }\r\n    ;\r\n    let xBefore = convert(xBeforeRaw, rect.width);\r\n    let yBefore = convert(yBeforeRaw, rect.height);\r\n    let xAfter = convert(xAfterRaw, rect.width);\r\n    let yAfter = convert(yAfterRaw, rect.height);\r\n    return {\r\n        x: {\r\n            before: xBefore,\r\n            after: xAfter,\r\n        },\r\n        y: {\r\n            before: yBefore,\r\n            after: yAfter,\r\n        },\r\n    };\r\n}\r\nfunction domRectIntersects(a, b, axis = 'both') {\r\n    return (axis === 'x' &&\r\n        a.right >= b.left &&\r\n        a.left <= b.right) || (axis === 'y' &&\r\n        a.bottom >= b.top &&\r\n        a.top <= b.bottom) || (axis === 'both' &&\r\n        a.right >= b.left &&\r\n        a.left <= b.right &&\r\n        a.bottom >= b.top &&\r\n        a.top <= b.bottom);\r\n}\r\nfunction getAllDescendants(parent) {\r\n    let children = [];\r\n    for (const child of parent.children) {\r\n        children = children.concat(child, getAllDescendants(child));\r\n    }\r\n    return children;\r\n}\r\nexport function getSnapPositions(parent, excludeOffAxis = true) {\r\n    const parentRect = parent.getBoundingClientRect();\r\n    const positions = {\r\n        x: {\r\n            start: [],\r\n            center: [],\r\n            end: [],\r\n        },\r\n        y: {\r\n            start: [],\r\n            center: [],\r\n            end: [],\r\n        },\r\n    };\r\n    const descendants = getAllDescendants(parent);\r\n    for (const axis of ['x', 'y']) {\r\n        const orthogonalAxis = axis === 'x' ? 'y' : 'x';\r\n        const axisStart = axis === 'x' ? 'left' : 'top';\r\n        const axisSize = axis === 'x' ? 'width' : 'height';\r\n        const axisScroll = axis === 'x' ? 'scrollLeft' : 'scrollTop';\r\n        for (const child of descendants) {\r\n            const childRect = child.getBoundingClientRect();\r\n            // Skip child if it doesn't intersect the parent's opposite axis (it can never be in view)\r\n            if (excludeOffAxis && !domRectIntersects(parentRect, childRect, orthogonalAxis)) {\r\n                continue;\r\n            }\r\n            const childStyle = window.getComputedStyle(child);\r\n            let [childAlignY, childAlignX] = childStyle.getPropertyValue('scroll-snap-align').split(' ');\r\n            if (typeof childAlignX === 'undefined') {\r\n                childAlignX = childAlignY;\r\n            }\r\n            const childAlign = axis === 'x' ? childAlignX : childAlignY;\r\n            const childOffsetStart = childRect[axisStart] - parentRect[axisStart] + parent[axisScroll];\r\n            switch (childAlign) {\r\n                case 'none':\r\n                    break;\r\n                case 'start':\r\n                    positions[axis].start.push(childOffsetStart);\r\n                    break;\r\n                case 'center':\r\n                    positions[axis].center.push(childOffsetStart + (childRect[axisSize] / 2));\r\n                    break;\r\n                case 'end':\r\n                    positions[axis].end.push(childOffsetStart + childRect[axisSize]);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    return positions;\r\n}\r\nexport function getScrollSnapPositions(element) {\r\n    const rect = element.getBoundingClientRect();\r\n    const scrollPadding = getScrollPadding(element);\r\n    const snapPositions = getSnapPositions(element);\r\n    const maxScroll = {\r\n        x: element.scrollWidth - element.offsetWidth,\r\n        y: element.scrollHeight - element.offsetHeight,\r\n    };\r\n    const clamp = (min, max) => (value) => Math.max(min, Math.min(max, value));\r\n    return {\r\n        x: unique([\r\n            ...snapPositions.x.start.map(v => v - scrollPadding.x.before),\r\n            ...snapPositions.x.center.map(v => v - (rect.width / 2)),\r\n            ...snapPositions.x.end.map(v => v - rect.width + scrollPadding.x.after),\r\n        ]\r\n            .map(clamp(0, maxScroll.x))),\r\n        y: unique([\r\n            ...snapPositions.y.start.map(v => v - scrollPadding.y.before),\r\n            ...snapPositions.y.center.map(v => v - (rect.height / 2)),\r\n            ...snapPositions.y.end.map(v => v - rect.height + scrollPadding.y.after),\r\n        ]\r\n            .map(clamp(0, maxScroll.y))),\r\n    };\r\n}\r\nfunction unique(iterable) {\r\n    return Array.from(new Set(iterable));\r\n}\r\n"],"names":["scrollSnapToNext","element","direction","scrollToOptions","behavior","scrollFuzz","axis","sign","maxScroll","scrollWidth","offsetWidth","scrollHeight","offsetHeight","scrollSnapPositions","getScrollSnapPositions","currentScrollPosition","nextScrollPositions","filter","pos","sort","a","b","nextScrollPosition","length","scrollTo","getScrollPadding","style","window","getComputedStyle","rect","getBoundingClientRect","xBeforeRaw","getPropertyValue","replace","yBeforeRaw","xAfterRaw","yAfterRaw","convert","raw","size","n","parseFloat","test","xBefore","width","yBefore","height","xAfter","yAfter","x","before","after","y","domRectIntersects","right","left","bottom","top","getAllDescendants","parent","children","child","concat","getSnapPositions","excludeOffAxis","parentRect","positions","start","center","end","descendants","orthogonalAxis","axisStart","axisSize","axisScroll","childRect","childStyle","childAlignY","childAlignX","split","childAlign","childOffsetStart","push","scrollPadding","snapPositions","clamp","min","max","value","Math","unique","map","v","iterable","Array","from","Set"],"mappings":"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"}